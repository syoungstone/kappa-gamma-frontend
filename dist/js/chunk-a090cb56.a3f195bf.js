(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a090cb56"],{"03cf":function(t,e,o){},"0c4f":function(t,e,o){"use strict";o.r(e);var r=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"narrow-wrapper"},[r("h1",[t._v("Initiate Pledges")]),t.noPledges?r("div",[r("p",{attrs:{id:"no-pledges"}},[t._v("There are currently no pledges to be found.")])]):t.loaded?r("div",{attrs:{id:"cards"}},[r("b-modal",{attrs:{id:"photo-modal",title:"Select Photo"},on:{ok:t.handleOk}},[r("form",{ref:"form",on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.handleSubmit(e)}}},[r("b-form-group",{attrs:{label:"Please enter photo URL","label-for":"url-input","invalid-feedback":"Invalid URL",state:t.photoState}},[r("b-form-input",{attrs:{id:"url-input",state:t.photoState,required:""},model:{value:t.tempPhoto,callback:function(e){t.tempPhoto=e},expression:"tempPhoto"}})],1)],1)]),t._l(t.pledges,(function(e){return r("b-card",{key:e.id,staticClass:"overflow-hidden pledge-card",staticStyle:{"max-width":"540px"},attrs:{"no-body":""}},[r("b-row",{attrs:{"no-gutters":""}},[r("b-col",{attrs:{md:"5"}},[e.photo?r("div",{staticClass:"thumbnail"},[r("img",{attrs:{src:e.photo,alt:"Profile photo"}})]):r("div",{staticClass:"thumbnail"},[r("img",{attrs:{src:o("da33"),alt:"Photo placeholder"}})])]),r("b-col",{attrs:{md:"7"}},[r("b-card-body",{staticClass:"card-body",attrs:{title:e.name_first+" "+e.name_last}},[r("b-form",{attrs:{id:"create-form"},on:{submit:function(o){return o.preventDefault(),t.initiate(e)}}},[r("b-form-group",{attrs:{id:"input-group-0",label:"Roll Number:","label-for":"input-0"}},[r("b-form-input",{attrs:{id:"input-0",type:"number",required:""},model:{value:e.roll_number,callback:function(o){t.$set(e,"roll_number",o)},expression:"pledge.roll_number"}})],1),r("b-button",{staticClass:"photo-button",on:{click:function(o){return t.selectPhoto(e.id)}}},[t._v("Upload Photo")]),r("b-button",{attrs:{variant:"primary",type:"submit"}},[t._v("Initiate")])],1)],1)],1)],1)],1)}))],2):r("LoadingSpinner"),t.error?r("div",{staticClass:"mt-3"},[r("strong",[t._v(t._s(t.error))])]):t._e()],1)},n=[],a=(o("c740"),o("bc3a")),i=o.n(a),s=o("d76c"),l={components:{LoadingSpinner:s["a"]},created:function(){this.load()},data:function(){return{noPledges:null,pledges:null,error:null,loaded:!1,photoId:null,tempPhoto:null,photoState:null}},methods:{selectPhoto:function(t){this.photoId=t,this.$bvModal.show("photo-modal")},initiate:function(t){var e=this;if(t.roll_number<=0)return this.$root.$children[0].showError("Roll number must be greater than 0."),!1;t.roll_number<parseInt(t.big_roll_number)?this.$root.$children[0].showError("Roll number must be greater than big's roll number."):(t.is_pledge=0,t.brother_status="active",t.good_standing=1,t.photo=t.photo?t.photo:null,i.a.post(this.$store.state.apiURL+"update_student.php?id="+t.id,t,{headers:{Authorization:this.$store.state.jwt}}).then((function(t){t.data.success?(e.$root.$children[0].showSuccess(t.data.message),e.load()):e.$root.$children[0].showError(t.data.message)})).catch((function(t){return e.$root.$children[0].showError(t)})))},load:function(){var t=this;i.a.get(this.$store.state.apiURL+"read_pledges.php",{headers:{Authorization:this.$store.state.jwt}}).then((function(e){t.pledges=e.data.body,t.loaded=!0})).catch((function(e){e.response&&404==e.response.status?t.noPledges=!0:t.$root.$children[0].showError(e),t.loaded=!0}))},checkUrlValidity:function(){var t=/^(?:(?:https?|ftp):\/\/)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/\S*)?$/;return this.photoState=t.test(this.tempPhoto)||""==this.tempPhoto,this.photoState},resetModal:function(){this.photoState=null},handleOk:function(t){t.preventDefault(),this.handleSubmit()},handleSubmit:function(){var t=this;if(this.checkUrlValidity()){var e=this.pledges.findIndex((function(e){return e.id==t.photoId}));this.pledges[e].photo=this.tempPhoto,this.photoId=null,this.tempPhoto=null,this.$nextTick((function(){t.$bvModal.hide("photo-modal")}))}}}},d=l,u=(o("1132"),o("2877")),c=Object(u["a"])(d,r,n,!1,null,"56892123",null);e["default"]=c.exports},1132:function(t,e,o){"use strict";o("55ce")},"55ce":function(t,e,o){},ac45:function(t,e,o){"use strict";o("03cf")},c740:function(t,e,o){"use strict";var r=o("23e7"),n=o("b727").findIndex,a=o("44d2"),i="findIndex",s=!0;i in[]&&Array(1)[i]((function(){s=!1})),r({target:"Array",proto:!0,forced:s},{findIndex:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),a(i)},d76c:function(t,e,o){"use strict";var r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"spinner-wrapper"}},[o("b-spinner",{staticStyle:{width:"3rem",height:"3rem"},attrs:{variant:"primary"}})],1)},n=[],a={name:"LoadingSpinner"},i=a,s=(o("ac45"),o("2877")),l=Object(s["a"])(i,r,n,!1,null,"046d5688",null);e["a"]=l.exports},da33:function(t,e,o){t.exports=o.p+"img/nophoto.11f4fe67.jpg"}}]);
//# sourceMappingURL=chunk-a090cb56.a3f195bf.js.map